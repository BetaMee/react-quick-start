{"version":3,"sources":["../server/server-cluster.js"],"names":["cluster","require","workers","process","env","LEANCLOUD_AVAILABLE_CPUS","isMaster","i","fork","on","worker","code","signal","console","log","pid"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;;AAEA;AACA,IAAIC,UAAUC,QAAQC,GAAR,CAAYC,wBAAZ,IAAwC,CAAtD;;AAEA,IAAIL,QAAQM,QAAZ,EAAsB;AACpB,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIL,OAApB,EAA6BK,GAA7B,EAAkC;AAChCP,YAAQQ,IAAR;AACD;;AAEDR,UAAQS,EAAR,CAAW,MAAX,EAAmB,UAACC,MAAD,EAASC,IAAT,EAAeC,MAAf,EAA0B;AAC3CC,YAAQC,GAAR,CAAY,+BAAZ,EAA6CJ,OAAOP,OAAP,CAAeY,GAA5D;AACAf,YAAQQ,IAAR;AACD,GAHD;AAID,CATD,MASO;AACLP,UAAQ,aAAR;AACD","file":"server-cluster.js","sourcesContent":["var cluster = require('cluster');\n\n// 进程数量建议设置为可用的 CPU 数量\nvar workers = process.env.LEANCLOUD_AVAILABLE_CPUS || 1;\n\nif (cluster.isMaster) {\n  for (var i = 0; i < workers; i++) {\n    cluster.fork();\n  }\n\n  cluster.on('exit', (worker, code, signal) => {\n    console.log('worker %s died, restarting...', worker.process.pid);\n    cluster.fork();\n  });\n} else {\n  require('./server.js');\n}\n"]}